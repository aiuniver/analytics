{% extends 'base.html' %}

{% from 'macros/tables.html' import tabs %}

{% block css %}
    <link href="{{ url_for('static', filename='css/group3/audience/index.css') }}" rel="stylesheet">
{% endblock css %}

{% block js %}
    <script type="text/javascript" src="{{ url_for('static', filename='js/group3/audience/index.js') }}"></script>
{% endblock js %}

{% block additional_links %}
    {% include 'group3/audience/additional-links.html' %}
{% endblock additional_links %}

{% block content %}
    <div class="card p-3">
        {{ form.render() }}
    </div>
    {% if tables %}
        {% macro table(header, row, loop) %}
            <div class="tab-pane fade {{'show active' if loop.index == 1 and tab is none or tab|int == loop.index else ''}}" id="turnover-{{loop.index}}" role="tabpanel" aria-labelledby="turnover-{{loop.index}}-tab">
                {% if (header != 'traffic_channel') and (header != 'Оборот на ЦА') and (header != 'ЦА') %}
                    <div class="group">
                        <h2>Профессия</h2>
                        {{ row[0]['Профессия'].to_html() |safe }}
                        <div class="card p-3">
                            <div class="links">
                                <a href="{{ url_for('group3:get_plot_csv') }}?value=channels_detailed, Маржинальность" class="btn btn-primary">Скачать отчет в csv</a>
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <h2>Образование</h2>
                        {{ row[1]['Образование'].to_html() |safe }}
                        <div class="card p-3">
                            <div class="links">
                                <a href="{{ url_for('group3:get_plot_csv') }}?value=channels_detailed, ROI" class="btn btn-primary">Скачать отчет в csv</a>
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <h2>Возраст</h2>
                        {{ row[2]['Возраст'].to_html() |safe }}
                        <div class="card p-3">
                            <div class="links">
                                <a href="{{ url_for('group3:get_plot_csv') }}?value=channels_detailed, Оборот на лида" class="btn btn-primary">Скачать отчет в csv</a>
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <h2>Заработок</h2>
                        {{ row[3]['Заработок'].to_html() |safe }}
                        <div class="card p-3">
                            <div class="links">
                                <a href="{{ url_for('group3:get_plot_csv') }}?value=channels_detailed, Прибыль" class="btn btn-primary">Скачать отчет в csv</a>
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <h2>IT сфера</h2>
                        {{ row[4]['IT сфера'].to_html() |safe }}
                    </div>
                    <div class="group">
                        <h2>Связано с числами</h2>
                        {{ row[5]['Связано с числами'].to_html() |safe }}
                    </div>
                    <div class="group">
                        <h2>Гуманитарий</h2>
                        {{ row[6]['Гуманитарий'].to_html() |safe }}
                    </div>
                    <div class="group">
                        <h2>Предприниматель, руководитель</h2>
                        {{ row[7]['Предприниматель, руководитель'].to_html() |safe }}
                    </div>
                    <div class="group">
                        <h2>Другое</h2>
                        {{ row[8]['Другое'].to_html() |safe }}
                    </div>
                {% else %}
                    {{ row |safe }}
                {% endif %}
            </div>
        {% endmacro %}
        {{ tabs(tables, table, tab) }}
    {% endif %}
{% endblock %}
